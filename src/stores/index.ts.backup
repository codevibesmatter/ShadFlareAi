/**
 * Legend State v3 Store Index
 * 
 * Central export point for all observables and state management utilities
 */

// Export individual store observables
export { aiChat$, aiChatActions, aiChatComputed, aiChatSelectors } from './ai-chat'

// Import stores for internal use
import { aiChat$ } from './ai-chat'

// Export types
export type { 
  ChatMessage, 
  WebSocketState, 
  VoiceState, 
  ChatSettings 
} from './ai-chat'

// Auth is now handled by Better Auth - export the simplified helpers
export { useAuth, useAuthHelpers, logout, logoutAllDevices } from './auth-simple'

// Root store interface for global state coordination
export interface RootStore {
  aiChat: typeof import('./ai-chat').aiChat$
  // auth is now handled by Better Auth's native state
}

// Store management utilities
export const storeUtils = {
  // Reset all stores to initial state
  resetAll: () => {
    aiChatActions.reset()
    // Auth reset is handled by Better Auth's signOut
  },
  
  // Get all store states for debugging
  getDebugState: () => ({
    aiChat: aiChat$.get()
    // auth state is handled by Better Auth
  }),
  
  // Subscribe to AI chat connection status
  onChatConnectionChange: (callback: (isConnected: boolean) => void) => {
    return aiChat$.websocket.isConnected.onChange(callback)
  }
}

// Development helpers
if (process.env.NODE_ENV === 'development') {
  // Attach stores to window for debugging
  ;(globalThis as unknown as Record<string, unknown>).__LEGEND_STORES__ = {
    auth: auth$,
    aiChat: aiChat$,
    getAuth: () => auth$.get(),
    getAIChat: () => aiChat$.get(),
    resetAll: storeUtils.resetAll,
    getDebugState: storeUtils.getDebugState
  }
}

// Export React hooks
export {
  useAuth,
  useAuthUser,
  useAuthState,
  useAuthSelector,
  useAuthActions,
  useAIChat,
  useAIChatMessages,
  useAIChatSettings,
  useAIChatWebSocket,
  useAIChatVoice,
  useAIChatState,
  useAIChatSelector,
  useAIChatActions,
  useStoreDebug
} from './hooks'

// Re-export Legend State utilities for convenience
export { observable } from '@legendapp/state'
export { syncObservable } from '@legendapp/state/sync'